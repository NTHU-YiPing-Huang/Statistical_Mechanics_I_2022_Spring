
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="_static/javascripts/modernizr.js"></script>
  
  
  
    <title>The diffusion equation &#8212; 2022 Statistical Mechanics (I) - PHYS521000</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/material.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Basic concepts in probability theory" href="basic_prob.html" />
    <link rel="prev" title="Scale invariance and the concept of universality class" href="scale_invariance.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue-grey data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#diffusion_eq" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="syllabus.html" title="2022 Statistical Mechanics (I) - PHYS521000"
           class="md-header-nav__button md-logo">
          
              <img src="_static/logo-wide.svg" height="26"
                   alt="2022 Statistical Mechanics (I) - PHYS521000 logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">2022 Statistical Mechanics (I) - PHYS521000</span>
          <span class="md-header-nav__topic"> The diffusion equation </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <script src="_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = ""versions.json"",
        target_loc = "../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="syllabus.html" class="md-tabs__link">2022 Statistical Mechanics (I) - PHYS521000</a></li>
          <li class="md-tabs__item"><a href="random_walk_and_emergent_properties.html" class="md-tabs__link">Random walk and emergent properties</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="syllabus.html" title="2022 Statistical Mechanics (I) - PHYS521000" class="md-nav__button md-logo">
      
        <img src="_static/logo-wide.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="syllabus.html"
       title="2022 Statistical Mechanics (I) - PHYS521000">2022 Statistical Mechanics (I) - PHYS521000</a>
  </label>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#diffusion-eq--page-root" class="md-nav__link">The diffusion equation</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#the-microscopic-model" class="md-nav__link">The microscopic model</a>
        </li>
        <li class="md-nav__item"><a href="#the-macroscopic-question" class="md-nav__link">The macroscopic question</a>
        </li>
        <li class="md-nav__item"><a href="#the-currents-and-the-locally-conserved-particle-number" class="md-nav__link">The currents and the locally conserved particle number</a>
        </li>
        <li class="md-nav__item"><a href="#the-effect-of-external-forces" class="md-nav__link">The effect of external forces</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#the-solution-of-the-diffusion-equation" class="md-nav__link">The solution of the diffusion equation</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#the-equilibrium-solution" class="md-nav__link">The equilibrium solution</a>
        </li>
        <li class="md-nav__item"><a href="#the-general-solution-of-the-diffusion-equation" class="md-nav__link">The general solution of the diffusion equation</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#the-fourier-method" class="md-nav__link">The Fourier method</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#why-the-fourier-method" class="md-nav__link">Why the Fourier method?</a>
        </li>
        <li class="md-nav__item"><a href="#the-solution-according-to-the-fourier-method" class="md-nav__link">The solution according to the Fourier method</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#green-s-function" class="md-nav__link">Green’s function</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/diffusion_eq.md">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<h1 id="diffusion-eq--page-root">The diffusion equation<a class="headerlink" href="#diffusion-eq--page-root" title="Permalink to this headline">¶</a></h1>

<h2 id="the-microscopic-model">The microscopic model<a class="headerlink" href="#the-microscopic-model" title="Permalink to this headline">¶</a></h2>
<p>The above-mentioned microscopic models give us exact results without approximations. We can ask: if we relax the fixed step size condition, what could be changed? Let’s start with the one-dimensional case. We use <span class="math notranslate nohighlight">\(r\)</span> to denote the displacement of the random walk with a random step size. The microscopic model can be described as</p>
<div class="math notranslate nohighlight">
\[
\underbrace{r(t+\Delta t)}_{\text{The position at }t+\Delta t}=\underbrace{r(t)}_{\text{Position at }t}+\underbrace{l(t)}_{\text{A random step at }t}.
\]</div>
<p>This expression means once the position of the particle at time <span class="math notranslate nohighlight">\(t\)</span> is known, the particle will move to a random new position <span class="math notranslate nohighlight">\(r(t+\Delta t)\)</span>. The microscopic environment is fluctuating wildly, so our reference particle will interact with its environment in a complicated way. We avoid this complication by approximating the coupling of our reference particle with the environment using an effective random displacement <span class="math notranslate nohighlight">\(l\)</span>.</p>
<p>The probability distribution function of the random step, <span class="math notranslate nohighlight">\(l\)</span>, is <span class="math notranslate nohighlight">\(\chi(l)\)</span>. In general, the distribution function can be any function. However, we would like to keep our results as general as possible. Therefore, instead of giving a specific functional form of <span class="math notranslate nohighlight">\(\chi(l)\)</span>, we take the opposite approach. We assume <span class="math notranslate nohighlight">\(\chi(l)\)</span> to be any function that satisfies the following conditions:</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\int \chi(z)dz=1\)</span>: It is the normalization condition. We include all the possible results, and the probability is locally conserved.</p></li>
<li><p><span class="math notranslate nohighlight">\(\langle z\rangle=\int z\chi(z)dz=0\)</span>: expectation value of the random step is zero.</p></li>
<li><p><span class="math notranslate nohighlight">\(\langle z^2\rangle=\int z^2\chi(z)dz=a^2\)</span>: The width of the distribution function is characterized by the parameter <span class="math notranslate nohighlight">\(a\)</span>. The requirement that the integral is convergent means the distribution function, <span class="math notranslate nohighlight">\(\chi(z)\)</span> cannot have a slowly decaying tail at large <span class="math notranslate nohighlight">\(|z|\)</span>.</p></li>
</ol>


<h2 id="the-macroscopic-question">The macroscopic question<a class="headerlink" href="#the-macroscopic-question" title="Permalink to this headline">¶</a></h2>
<p>In the macroscopic world, we rarely keep track of the microscopic motion of the molecules. Instead, it is more convenient to describe the little particles using a function, <span class="math notranslate nohighlight">\(\rho(r,t)\)</span>, that describes the density field.</p>
<div class="tip admonition">
<p class="admonition-title">What?</p>
<p>Let’s try to think more carefully about how this field is constructed. As we know, the microscopic particles fluctuate at the microscopic length scale. When we define our density field, we evaluate the density at <span class="math notranslate nohighlight">\(r\)</span> by average the particle number over a length scale <span class="math notranslate nohighlight">\(\delta r\)</span>. That is, <span class="math notranslate nohighlight">\(\rho(r,t)=\frac{N_{\delta_r}}{\delta r}\)</span> where <span class="math notranslate nohighlight">\(N_{\delta_r}\)</span> represent the number of particles in <span class="math notranslate nohighlight">\([r-\frac{\delta r}{2},r+\frac{\delta r}{2}]\)</span>. How to choose <span class="math notranslate nohighlight">\(\delta r\)</span>? We hope we can choose <span class="math notranslate nohighlight">\(\delta r\)</span> large enough such that <span class="math notranslate nohighlight">\(\rho(r,t)\)</span> is not fluctuating too much. Why should we expect the fluctuation to become small when <span class="math notranslate nohighlight">\(\delta r\)</span> is large enough? Small compared with what? What happens if <span class="math notranslate nohighlight">\(\delta r\)</span> is too small? What do we mean by “not fluctuating too much”? If we perform a similar analysis in time, what does that mean?</p>
</div>
<div class="figure align-default" id="density-evolution">
<a class="reference internal image-reference" href="_images/diff_den_6.png"><img alt="_images/diff_den_6.png" src="_images/diff_den_6.png" style="width: 750px;"/></a>
<p class="caption"><span class="caption-number">Fig. 7 </span><span class="caption-text">Evolution of the density field.</span><a class="headerlink" href="#density-evolution" title="Permalink to this image">¶</a></p>
</div>
<p>The question we would like to understand at the macroscopic level is: how does the density field change as a function of time if the microscopic components are doing the random walk we proposed at the microscopic model?</p>
<p>The density field at <span class="math notranslate nohighlight">\(x\)</span> is described by</p>
<div class="math notranslate nohighlight">
\[
\rho(x,t+\Delta t)=\int_{-\infty}^{\infty} \rho(x',t) \chi(x-x')dx'.
\]</div>
<p>Here, we make the change of variable <span class="math notranslate nohighlight">\(z=x-x'\)</span> and</p>
<div class="math notranslate nohighlight">
\[
\rho(x, t+\Delta t)=\int_{-\infty}^{\infty} \rho(x-z,t) \chi(z)dz.
\]</div>
<p>Here, we expand RHS by assuming <span class="math notranslate nohighlight">\(z\)</span> to be small. When <span class="math notranslate nohighlight">\(z\)</span> is large, the probability distribution function <span class="math notranslate nohighlight">\(\chi(z)\)</span> decays very fast. Then we have</p>
<div class="math notranslate nohighlight">
\[
RHS\approx \int \left[\rho(x,t) -z\left.\frac{\partial \rho}{\partial z}\right|_{z=x}+\frac{z^2}{2}\left.\frac{\partial^2 \rho}{\partial z^2}\right|_{z=x}\right]\chi(z)dz.
\]</div>
<p>Using the assumptions we have made to our probability distribution functions, we can simplify the expression as</p>
<div class="math notranslate nohighlight">
\[
RHS\approx \rho(x,t)+\frac{a^2}{2}\left.\frac{\partial^2 \rho}{\partial z^2}\right|_{z=x}=\rho(x,t)+\frac{a^2}{2}\frac{\partial^2 \rho}{\partial x^2}.
\]</div>
<p>The LHS can be simplified as</p>
<div class="math notranslate nohighlight">
\[
\rho(x,t+\Delta t)\approx \rho(x,t)+\frac{\partial \rho}{\partial t}\Delta t.
\]</div>
<p>This relation leads to the diffusion equation</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \rho}{\partial t}=\frac{a^2}{2\Delta t}\frac{\partial^2 \rho}{\partial x^2}.
\]</div>
<p>Finally, we have successfully built the macroscopic description using a microscopic model with parameters <span class="math notranslate nohighlight">\(\frac{a^2}{2\Delta t}\)</span>.</p>
<p>The diffusion equation can also be derived phenomenologically, where we use <span class="math notranslate nohighlight">\(D\)</span>, the diffusion coefficient, to describe the diffusion equation as</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \rho}{\partial t}=D\frac{\partial^2 \rho}{\partial x^2}.
\]</div>


<h2 id="the-currents-and-the-locally-conserved-particle-number">The currents and the locally conserved particle number<a class="headerlink" href="#the-currents-and-the-locally-conserved-particle-number" title="Permalink to this headline">¶</a></h2>
<p>Consider a one-dimensional system where we pick a segment of length <span class="math notranslate nohighlight">\(\Delta x\)</span>. We can ask: what is the change in the number of particles in this segment? A simple derivation gives</p>
<div class="math notranslate nohighlight">
\[
d \rho(x) \Delta x=\left[J(x)-J(x+\Delta x)\right]dt.
\]</div>
<p>When we take the <span class="math notranslate nohighlight">\(\Delta x\to0\)</span> limit, we will have</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \rho}{\partial t}=-\frac{\partial J}{\partial x}.
\]</div>
<p>This expression helps us to understand the current for the diffusion equation. Combining this relation with the diffusion equation, we have</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial J}{\partial x}=-D\frac{\partial^2\rho}{\partial x^2}.
\]</div>
<p>We can integrate this equation from both ends to get the expression of the diffusion current. Here, the constant of integral should be zero since the microscopic model is an unbiased random walk with no background current.</p>
<div class="tip admonition">
<p class="admonition-title">What?</p>
<p>Suppose we have a density profile of the Gaussian function; what is the expression of the diffusion current?</p>
</div>


<h2 id="the-effect-of-external-forces">The effect of external forces<a class="headerlink" href="#the-effect-of-external-forces" title="Permalink to this headline">¶</a></h2>
<p>When we have external force, we modify our microscopic model as</p>
<div class="math notranslate nohighlight">
\[
r(t+\Delta t)=r(t)+l(t)+F\gamma\Delta t.
\]</div>
<p>The additional term, <span class="math notranslate nohighlight">\(F\gamma\Delta t\)</span> is the displacement from a constant external field. We assume the particle’s velocity is zero between the random walk events, the displacement for uniform acceleration motion is</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{2} \frac{F}{m}\Delta t^2=F\gamma\Delta t.
\]</div>
<p>From this expression, we can derive <span class="math notranslate nohighlight">\(\gamma\)</span> as</p>
<div class="math notranslate nohighlight">
\[
\gamma=\frac{\Delta t}{2m}=\frac{\Delta t}{2m}\underbrace{\left(D \frac{2\Delta t}{a^2}\right)}_{\text{from the previous expression of diffusion coefficient}}=\frac{D}{m\left(a/\Delta t\right)^2}=\frac{D}{m\overline{v}^2}\text{.}
\]</div>
<p>Here <span class="math notranslate nohighlight">\(\overline{v}\)</span> is the average velocity between <span class="math notranslate nohighlight">\((t,t+\Delta t)\)</span>.
With similar arguments, we can derive the diffusion equation and the current under the influence of external force to be</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \rho}{\partial t}=-\gamma F\frac{\partial \rho}{\partial x}+D\frac{\partial^2 \rho}{\partial x^2}=-\frac{\partial J}{\partial x}
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
J=\gamma F\rho-D\frac{\partial \rho}{\partial x}\text{.}
\]</div>



<h1 id="the-solution-of-the-diffusion-equation">The solution of the diffusion equation<a class="headerlink" href="#the-solution-of-the-diffusion-equation" title="Permalink to this headline">¶</a></h1>
<p>We would like to understand how the density profile <span class="math notranslate nohighlight">\(\rho(r,t)\)</span> evolve in time and space. It will give us a rough picture of how a system reaches <em>equilibrium</em>. The evolution process toward equilibrium is a complicated process in both classical and quantum systems. The random walk process is the simplest one that can give us a rough picture. We will start from the equilibrium solution, <span class="math notranslate nohighlight">\(\frac{\partial \rho^*(r)}{\partial t}=0\)</span>. Then, we will discuss the general solution <span class="math notranslate nohighlight">\(\rho(r,t)\)</span>.</p>
<div class="tip admonition">
<p class="admonition-title">What?</p>
<p>We also learn a similar concept, the steady-state. How the idea of equilibrium differs from the idea of steady-state? In this section of the lecture note, I did not distinguish the concept clearly. However, the two ideas are subtlely different.</p>
</div>

<h2 id="the-equilibrium-solution">The equilibrium solution<a class="headerlink" href="#the-equilibrium-solution" title="Permalink to this headline">¶</a></h2>
<p>There are two cases for the equilibrium solution–the case without an external field and the case with an external field. I will discuss both cases.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(F=0\)</span>: <span class="math notranslate nohighlight">\(\frac{\partial {\rho^*}\,^2}{\partial x^2}=D^{-1}\frac{\partial \rho}{\partial t}=0\rightarrow \rho^*=\rho_0+Bx\)</span>. Here, <span class="math notranslate nohighlight">\(\rho_0\)</span> and <span class="math notranslate nohighlight">\(B\)</span> are the constants to be determined. Suppose we study a system of particles confined by a solid container. At the boundary, the current needs to be 0. This leads to the boundary condition <span class="math notranslate nohighlight">\(J=0=-D\frac{\partial \rho^*}{\partial x_{boundary}}=-DB\)</span>. That is, <span class="math notranslate nohighlight">\(B=0\)</span>. So the equilibrium solution, in this case, is the homogeneous distribution, <span class="math notranslate nohighlight">\(\rho^*=\rho_0\)</span> is constant.</p></li>
<li><p><span class="math notranslate nohighlight">\(F=-mg\)</span>: Consider the case with gravity. We have <span class="math notranslate nohighlight">\(\frac{\partial \rho^*}{\partial t}=\gamma mg \frac{\partial \rho^*}{\partial x}+D\frac{\partial^2 \rho^*}{\partial x^2}\)</span>. The solution of this equation is <span class="math notranslate nohighlight">\(\rho^*(x)=A e^{-\frac{\gamma mgx}{D}}+B\)</span>. With the boundary condition that the density is zero at the end of the universe, we have <span class="math notranslate nohighlight">\(\rho^*(x\to\infty)=0, B=0\)</span>. We have the solution <span class="math notranslate nohighlight">\(\rho^*(x)=A e^{-\frac{\gamma mgx}{D}}\)</span>.</p></li>
</ul>
<p>Now we know the behavior of the equilibrium solution, we will further tackle the evolution of the density profile for arbitrary time <span class="math notranslate nohighlight">\(t\)</span>.</p>


<h2 id="the-general-solution-of-the-diffusion-equation">The general solution of the diffusion equation<a class="headerlink" href="#the-general-solution-of-the-diffusion-equation" title="Permalink to this headline">¶</a></h2>
<p>We will introduce two methods to solve the diffusion equation. The “solution” of the diffusion equation means we know the density profile for arbitrary space-time once an initial condition, <span class="math notranslate nohighlight">\(\rho_i(x,t=t_i=0)\)</span>, is given. In general, this process is quite complicated. However, the fact that the diffusion equation is a linear equation simplifies the analysis a lot. The key question we should ask is: are there quantities that are kept fixed during the time evolution? We have learned several conserved quantities in the past. Usually, they are related to the symmetry of the system. The important symmetry for later analysis is the translational symmetry in space. That’s why we will start the analysis from the Fourier method. Once we know how the Fourier method works in general, we will apply that to a special initial condition, the Dirac delta function. We will see the property of Dirac delta function provides a convenient structure to define Green’s function of the diffusion equation. Using the Green’s function, we can construct the evolution of the density profile for arbitrary space-time.</p>
<div class="tip admonition">
<p class="admonition-title">What?</p>
<p>Are the energy and momentum conserved quantities in the microscopic random walk model? In a physical system, should they be conserved?</p>
</div>

<h3 id="the-fourier-method">The Fourier method<a class="headerlink" href="#the-fourier-method" title="Permalink to this headline">¶</a></h3>

<h4 id="why-the-fourier-method">Why the Fourier method?<a class="headerlink" href="#why-the-fourier-method" title="Permalink to this headline">¶</a></h4>
<p>Our system has translation symmetry. We would like to use that property to simplify our analysis. Let <span class="math notranslate nohighlight">\(T_{\Delta}\)</span> denote the translation operator that shifts the system by displacement <span class="math notranslate nohighlight">\(\Delta\)</span>. We want to analyze the time evolution of our system; we can use <span class="math notranslate nohighlight">\(U_t\)</span> to express the time evolution of the density profile formally. By definition, we have <span class="math notranslate nohighlight">\(\rho_{k}(x,t)=U_t[\rho_k(x,0)]\)</span>. Here, <span class="math notranslate nohighlight">\(k\)</span> is the conserved quantity that is invariant under the time evolution. If such <span class="math notranslate nohighlight">\(k\)</span> exist, it will be helpful for us to analyze the problem. The translational symmetry of our system is equivalent to the following formal expression.</p>
<div class="math notranslate nohighlight">
\[
T_{\Delta}\left\{U_t\left[\rho_k(x,0)\right]\right\} =U_t\left\{T_{\Delta}\left[\rho_k(x,0)\right]\right\}
\]</div>
<p>In other words, the result of the shifted density profile after the time evolution from an initial condition, <span class="math notranslate nohighlight">\(\rho(x,0)\)</span>, is identical with the time evolution from a shifted initial condition.</p>
<p>Next, we discuss the meaning of the quantity <span class="math notranslate nohighlight">\(k\)</span>. If we consider the translation operator as a matrix, then the eigensystem of the translation operator is labeled by <span class="math notranslate nohighlight">\(k\)</span>. That is,</p>
<div class="math notranslate nohighlight">
\[
T_{\Delta}\left[\rho_k(x,0)\right]=\lambda_k\rho_k(x,0).
\]</div>
<p>If we can find the eigenvalues and eigenvectors of the translational operator, <span class="math notranslate nohighlight">\(T_{\Delta}\)</span>. That will be great! Because we can build the following relation</p>
<div class="math notranslate nohighlight">
\[\begin{split}
T_{\Delta}\left\{U_t\left[\rho_k(x,0)\right]\right\} =U_t\left\{T_{\Delta}\left[\rho_k(x,0)\right]\right\} \text{(Translation symmetry)}\\
=U_t\left\{\lambda_k\rho_k(x,0)\right\} \text{(Eigensystem of translation operator)}\\
=\lambda_k \rho_k(x,t)\text{(The time evolved eigenvector is labeled by the same index $k$!)}
\end{split}\]</div>
<p>The above relation says the eigenvalues of <span class="math notranslate nohighlight">\(T_{\Delta}\)</span>  is invariant under the time evolution. The next question is: what are the eigenvalues and eigenvectors of the translation operator? From the definition of eigensystems, we have</p>
<div class="math notranslate nohighlight">
\[
T_{\Delta}\left[\rho_k(x,0)\right]=\lambda_k \rho_k(x,0)=\rho_k(x-\Delta,0).
\]</div>
<p>We can just stare at it, and find a simple solution, <span class="math notranslate nohighlight">\(\rho_{k}(x,0)=e^{ikx}\)</span> and <span class="math notranslate nohighlight">\(\lambda_k=e^{-ik\Delta}\)</span>. So if we expand the initial condition using the eigenvector, <span class="math notranslate nohighlight">\(\rho_k(x,t)\)</span>, the evolution of each component will be labeled by <span class="math notranslate nohighlight">\(k\)</span>.</p>
<div class="tip admonition">
<p class="admonition-title">What?</p>
<p>Symmetry plays an important role in physics. Especially, the representation of the symmetry operator helps us to formulate and analyze the problem. In this case, the translation operator forms an abelian group(Which means the order of applying the translation operator is not important). The irreducible representation of the abelian group is one-dimensional. So we can use <span class="math notranslate nohighlight">\(e^{-ik\Delta}\)</span> to represent the translational operator. From the representation theory of the group, we can rationalize where this solution came from.
<span id="id1">[<a class="reference internal" href="biblio.html#id4">Tin03</a>]</span></p>
</div>


<h4 id="the-solution-according-to-the-fourier-method">The solution according to the Fourier method<a class="headerlink" href="#the-solution-according-to-the-fourier-method" title="Permalink to this headline">¶</a></h4>
<p>Now, we know why we want to use the Fourier method to simplify our result. The diffusion equation is a linear equation. In other words, if <span class="math notranslate nohighlight">\(\rho_1\)</span> and <span class="math notranslate nohighlight">\(\rho_2\)</span> are both the solution of the diffusion equation, the linear combination <span class="math notranslate nohighlight">\(c_1\rho_1+c_2\rho_2\)</span> for arbitrary <span class="math notranslate nohighlight">\(c_1\)</span> and <span class="math notranslate nohighlight">\(c_2\)</span> will also be a solution. So if we can use the eigenvectors to expand our general solution, all we need to do is to find the solution for each <span class="math notranslate nohighlight">\(k\)</span> component. The following steps show how the Fourier method works.</p>
<ul class="simple">
<li><p>We can expand the density profile as <span class="math notranslate nohighlight">\(\rho(x,t)=\sum_k\widetilde{\rho_k}(t)e^{ikx}\)</span>.</p></li>
<li><p>Insert this expression into the diffusion equation; we found the eigenvectors will not mix with each other. Therefore, we can focus on a single mode <span class="math notranslate nohighlight">\(k\)</span>.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\frac{\partial}{\partial t}\left[\widetilde{\rho_k}(t)e^{ikx}\right]=D\frac{\partial^2}{\partial x^2}\left[\widetilde{\rho_k}(t)e^{ikx}\right]\\
\frac{\partial}{\partial t}\widetilde{\rho_k}(t)=D(-k^2)\widetilde{\rho_k}(t)
\end{split}\]</div>
<p>We can derive the solution of the above equation as</p>
<div class="math notranslate nohighlight">
\[
\widetilde{\rho_k}(t)=\widetilde{\rho_k}(0)e^{-Dk^2t}
\]</div>
<ul class="simple">
<li><p>We can use the <span class="math notranslate nohighlight">\(t=0\)</span> density profile to get <span class="math notranslate nohighlight">\(\widetilde{\rho_k}(0)\)</span>.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\widetilde{\rho_k}(0)=\int_{-\infty}^{\infty}\rho(x,t=0)e^{-ikx}dx\text{.}
\]</div>
<ul class="simple">
<li><p>The solution is</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\rho(x,t)=\frac{1}{N}\sum_{k} \left[\widetilde{\rho_k}(0)e^{-Dk^2t}\right]e^{ikx}\xrightarrow{\text{continuous limit}}\frac{1}{2\pi}\int_{-\infty}^{\infty}\left[\widetilde{\rho_k}(0)e^{-Dk^2t}\right]e^{ikx}dx
\]</div>
<p>We can see the solution suggests the high wave vector modes will decay exponentially, <span class="math notranslate nohighlight">\(e^{-Dk^2t}\)</span>.</p>
<p>The above steps suggest that we need to get <span class="math notranslate nohighlight">\(\widetilde{\rho_k}(t=0)\)</span> by performing Fourier analysis of the density profile at <span class="math notranslate nohighlight">\(t=0\)</span>, <span class="math notranslate nohighlight">\(\rho(x,t=0)\)</span>. Then, we reconstruct the evolution of the density profile by integration over <span class="math notranslate nohighlight">\(k\)</span>. The process can be carried out. However, it will be better if, for an arbitrary given initial condition, we can derive the density profile at an arbitrary space-time point. We will introduce the idea of Green’s function, which serves this purpose.</p>



<h3 id="green-s-function">Green’s function<a class="headerlink" href="#green-s-function" title="Permalink to this headline">¶</a></h3>
<p>The method of Green’s function is based on a property of Dirac delta function. That is, we can express an arbitrary function using the Dirac delta function.</p>
<div class="math notranslate nohighlight">
\[
F(x)=\int F(x-y)\delta(y)dy\text{.}
\]</div>
<p>Instead of asking how each component of <span class="math notranslate nohighlight">\(k\)</span> evolves as a function of time, Green’s function method asks another question: if the initial profile is a Dirac delta function, how does it evolve as a function of time? We can apply the Fourier method to this special initial condition to answer this question. We define the time evolution of a Dirac delta function to be <span class="math notranslate nohighlight">\(G(x,t)\)</span>.</p>
<p>We then use the Fourier method to derive <span class="math notranslate nohighlight">\(G(x,t)\)</span>.</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\widetilde{G_k}(t=0)=\int G(x,t=0)e^{-ikx}dx=1\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(G(x,t)=\frac{1}{2\pi}\int e^{ikx}e^{-Dk^2t}dk=\frac{1}{\sqrt{4\pi Dt}}e^{-\frac{x^2}{4Dt}}\)</span> is the solution we are looking for.</p></li>
</ol>
<p>The time-evolution of arbitrary density profile is</p>
<div class="math notranslate nohighlight">
\[
\rho(x,t)=\int \rho(y,t=0)G(x-y,t)dy=\int\rho(y,t=0)\left[\frac{1}{\sqrt{4\pi Dt}}e^{-\frac{x^2}{4Dt}}\right]dy\text{.}
\]</div>
<p>To get the time evolution of a density profile, all we need to do is to input the density profile at time <span class="math notranslate nohighlight">\(t=0\)</span> into the above expression.</p>
<p>Now let’s look at the Green’s function; we found it is a Gaussian function with standard deviation <span class="math notranslate nohighlight">\(\sigma(t)=\sqrt{2Dt}\)</span>. From our previous simple model, we know <span class="math notranslate nohighlight">\(D=\frac{a^2}{2\Delta t}\)</span>. Then we got <span class="math notranslate nohighlight">\(\sigma(t)=\sqrt{2\frac{a^2}{2\Delta t}t}=a\sqrt{t/\Delta t}=a\sqrt{N}\)</span> which is equivalent with the <span class="math notranslate nohighlight">\(N\)</span>-steps random walk with step size <span class="math notranslate nohighlight">\(a\)</span>. To some extent, Green’s function having a function form of a Gaussian is closely related to the central limit theorem.  The central limit theorem suggests the sum of independent variables has a probability distribution function that converges to a Gaussian. We will prove the central limit theorem in our homework 1.</p>
<p>Now we know how to solve a diffusion equation and how it reaches equilibrium. However, for generic closed classical or quantum systems, how the system reaches equilibrium is still an open question. We will not elaborate more on this fascinating research problem. Instead, we will refer our readers to other sources that discuss these interesting topics ( see, <em>e.g.</em> Thermalization and many-body localization, see <span id="id2">[<a class="reference internal" href="biblio.html#id7">Sre94</a>]</span> and <span id="id3">[<a class="reference internal" href="biblio.html#id6">NH14</a>]</span> )</p>



<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>

          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="scale_invariance.html" title="Scale invariance and the concept of universality class"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Scale invariance and the concept of universality class </span>
              </div>
            </a>
          
          
            <a href="basic_prob.html" title="Basic concepts in probability theory"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Basic concepts in probability theory </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2021.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.5.4.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>